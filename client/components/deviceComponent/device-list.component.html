<div [hidden]="!isLoading" class="loader-line"></div>

<div class="container-fluid">


    <div class="row">
        <div class="col-lg-12">
            <h2 class="page-header">Registered Devices</h2>
        </div>
    </div>


    <div class="row">
        <div class="col-md-8">
            <fieldset>
                <legend>Search</legend>
                <div class="form-inline search-form">
                    <div class="form-group">
                        <input type="number" class="form-control" id="latitudeKeyFilter" placeholder="Latitude Filter"
                               [(ngModel)]="latitudeFilter">
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-control" id="longitudeKeyFilter" placeholder="Longitude Filter"
                               [(ngModel)]="longitudeFilter">
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-control" id="radiusKeyFilter" min="0" placeholder="Radius Filter"
                               [(ngModel)]="radiusFilter">
                    </div>
                </div>
                <div class="form-inline search-form">
                    <div class="form-group">
                        <input type="text" class="form-control" id="stringKeyFilter" placeholder="Key Filter"
                               [(ngModel)]="keyFilter">
                    </div>
                    <div class="form-group">
                        <label for="devicePageCount">Devices per Page</label>
                        <select class="form-control" id="devicePageCount"
                                (change)="onChangePageSize($event.target.value)">
                            <option value="10">10</option>
                            <option value="25">25</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                    </div>
                </div>
                <hr>
            </fieldset>
        </div>
    </div>


    <div class="row">
        <div class="col-md-8">
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th style="width: 100px;">#</th>
                        <th style="width: 100px;">Select</th>
                        <th style="width: 50px;">Status</th>
                        <th>Id</th>
                        <th>Latitude</th>
                        <th>Longitude</th>
                        <th style="width: 150px;">Action</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let device of devices| stringFilter: keyFilter | locationFilter:latitudeFilter: longitudeFilter: radiusFilter
                    | paginate: configPagination; let i = index">
                        <td>{{i + 1}}</td>
                        <td>
                            <input type="checkbox"
                                   (change)="updateSelectedDevices(device.$key, $event)">
                        </td>
                        <td [innerHTML]="onlineStatus(device)">
                        </td>
                        <td>
                            {{device.$key}}
                        </td>
                        <td>
                            {{device.l[0]}}
                        </td>
                        <td>
                            {{device.l[1]}}
                        </td>
                        <td>
                            <a class="btn btn-primary btn-group-sm"
                               [routerLink]="['/device', device.$key]">View
                            </a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <pagination-controls #p
                                 [id]="configPagination.id"
                                 (pageChange)="configPagination.currentPage = $event">

                <ul class="pagination">
                    <li class="pagination-previous" [class.disabled]="p.isFirstPage()" *ngIf="p.directionLinks">
                        <a *ngIf="!p.isFirstPage()" (click)="p.previous()"> &laquo; </a>
                    </li>

                    <li *ngFor="let page of p.pages" [class.current]="p.getCurrent() === page.value">
                        <a (click)="p.setCurrent(page.value)" *ngIf="p.getCurrent() !== page.value">
                            <span>{{ page.label }}</span>
                        </a>
                        <a *ngIf="p.getCurrent() === page.value">
                            <span>{{ page.label }}</span>
                        </a>
                    </li>

                    <li class="pagination-next" [class.disabled]="p.isLastPage()" *ngIf="p.directionLinks">
                        <a *ngIf="!p.isLastPage()" (click)="p.next()"> &raquo; </a>
                    </li>
                </ul>

            </pagination-controls>

            <button [disabled]="!selectedDevices.length" class="btn btn-primary pull-right"> Manage Selected Devices</button>

        </div>
    </div>
</div>